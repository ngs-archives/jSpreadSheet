/**
 * jSpreadSheet
 * @author    <a href="http://ngsdev.org">Atsushi Nagase</a>
 * @copyright Copyright &copy; 2009-2010 Atsushi Nagase
 * @license   Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*/
;(function(j){function q(c){c=c||10;for(var a="",d,e,n=function(l,b){var f=String.fromCharCode(l);return b?f.toUpperCase():f.toLowerCase()};a.length<c;){e=65+Math.floor(25*Math.random())+(e>90?0:10);if((d=e>90?String(e-90-1):n(e,Math.random()<0.5))&&a[a.length-1]!=d)a+=d}return a}function r(c){var a=[];c.out="json";for(var d in c)a.push([d,c[d]].join(":"));return a.join(";")}var s={version:"0.6"},t=0,m={};j.ss=function(c,a){function d(b,f){if(/^(ok|warning)$/.test(b.status)){var g=b.table,k=[],h=n||
[];if(typeof h=="string")h=h.split(",");j.each(g.rows,function(){var i={};j.each(this.c,function(o){i[h[o]||o]=(this||{}).v});k.push(i)});f.apply(j(k),[true])}else f.apply({errors:b.errors||[]},[false])}a=j.extend(s,a);var e,n,l={setQuery:function(b){e=b;return l},setField:function(b){n=b;return l},send:function(b,f){var g=encodeURIComponent(c),k=encodeURIComponent(e||"__NO_QUERY__");m[g]=m[g]||{};if(!f&&m[g][k])d(m[g][k],b);else{var h=t++;do var i="sscallback_"+q(20);while(window[i]);window[i]=function(p){if(p.reqId==
h.toString()){if(p.table)m[g][k]=p;d(p,b)}setTimeout(function(){try{delete window[i]}catch(u){}},1)};a.responseHandler=i;a.reqId=h;var o=c+"&tqx="+r(a)+"&tq="+encodeURIComponent(e||"");j.ajax({url:o,type:"GET",dataType:"script",scriptCharset:"utf-8",data:null})}}};return l}})(jQuery);;
