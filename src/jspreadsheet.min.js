/**
 * jSpreadSheet
 * @author    <a href="http://ngsdev.org">Atsushi Nagase</a>
 * @copyright Copyright &copy; 2009-2010 Atsushi Nagase
 * @license   Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*/
;(function(e){function n(b){b=b||10;for(var a="",d,c,e=function(a,j){var b=String.fromCharCode(a);return j?b.toUpperCase():b.toLowerCase()};a.length<b;)c=65+Math.floor(25*Math.random())+(c>90?0:10),(d=c>90?String(c-90-1):e(c,Math.random()<0.5))&&a[a.length-1]!=d&&(a+=d);return a}function o(b){var a=[];b.out="json";for(var d in b)a.push([d,b[d]].join(":"));return a.join(";")}var p={version:"0.6"},q=0,h={};e.ss=function(b,a){function d(a,b){if(/^(ok|warning)$/.test(a.status)){var d=a.table,c=[],f=k||
[];typeof f=="string"&&(f=f.split(","));e.each(d.rows,function(){var a={};e.each(this.c,function(b){a[f[b]||b]=(this||{}).v});c.push(a)});b.apply(e(c),[!0])}else b.apply({errors:a.errors||[]},[!1])}a=e.extend(p,a);var c,k,g={setQuery:function(a){c=a;return g},setField:function(a){k=a;return g},send:function(j,g){var i=encodeURIComponent(b),m=encodeURIComponent(c||"__NO_QUERY__");h[i]=h[i]||{};if(!g&&h[i][m])d(h[i][m],j);else{var f=q++;do var l="sscallback_"+n(20);while(window[l]);window[l]=function(a){a.reqId==
f.toString()&&(a.table&&(h[i][m]=a),d(a,j));setTimeout(function(){try{delete window[l]}catch(a){}},1)};a.responseHandler=l;a.reqId=f;var k=b+"&tqx="+o(a)+"&tq="+encodeURIComponent(c||"");e.ajax({url:k,type:"GET",dataType:"script",scriptCharset:"utf-8",data:null})}}};return g}})(jQuery);;
